<!-- Fixed Top Bar -->
<header class="fixed top-0 left-0 right-0 bg-white border-b shadow-sm z-50 px-5 py-3 flex justify-between items-center">
    <h1 class="text-lg md:text-xl font-semibold text-gray-800">Exam Session</h1>
    <div class="flex items-center gap-4">
        <div class="text-gray-600 font-medium text-sm md:text-base">
            Time Remaining:
            <span class="text-blue-600 font-semibold">{{ formatTime(timeRemaining()) }}</span>
        </div>
        <button (click)="submitExam()"
            class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition">
            Submit
        </button>
    </div>
</header>

<!-- Main Exam Area -->
<main class="pt-20 pb-28 px-4 md:px-8 bg-gray-50 transition-all duration-300">
    <div
        class="bg-white rounded-xl shadow-md border border-gray-100 p-6 md:p-10 animate-fade-in space-y-8 max-w-7xl mx-auto">
        <div class="flex justify-between items-center">
            <h2 class="text-lg md:text-xl font-semibold text-gray-800">
                Question {{ currentQuestionIndex() + 1 }}
            </h2>
            <span class="text-sm text-gray-500">
                {{ getAnsweredSubparts(currentQuestion) }}
            </span>
        </div>

        <!-- Subparts -->
        <div class="space-y-8">
            @for (sp of currentQuestion.subparts; track sp.id) {
            <div class="space-y-3">
                <div>
                    <div class="text-sm font-semibold text-gray-700 mb-1">{{ sp.label }}</div>
                    <div class="text-gray-700 text-sm md:text-base">{{ sp.question }}</div>
                </div>

                <!-- ngx-editor -->
                <div class="ngx-editor-container border border-gray-200 rounded-lg">
                    <ngx-editor-menu [editor]="getEditor(sp.id)" [toolbar]="toolbar"></ngx-editor-menu>
                    <ngx-editor [editor]="getEditor(sp.id)" [(ngModel)]="sp.answer"
                        [placeholder]="'Type your answer here...'" [outputFormat]="'html'">
                    </ngx-editor>
                </div>
            </div>
            }
        </div>
    </div>
</main>

<!-- Bottom Navigation -->
<footer
    class="fixed bottom-0 left-0 right-0 bg-white border-t shadow-sm px-4 md:px-8 py-3 flex justify-between items-center z-40">
    <button (click)="prevQuestion()" [disabled]="currentQuestionIndex() === 0"
        class="text-gray-600 hover:text-gray-900 font-medium text-sm disabled:opacity-40 transition">
        Previous
    </button>

    <div class="flex items-center gap-2 overflow-x-auto">
        @for (q of questions(); track i; let i = $index) {
        <button (click)="goToQuestion(i)"
            class="relative px-3 py-1 rounded-lg text-sm font-medium border transition-all" [ngClass]="{
        'bg-blue-600 text-white border-blue-600': currentQuestionIndex() === i,
        'bg-gray-100 text-gray-700 border-gray-200 hover:bg-gray-200':
          currentQuestionIndex() !== i
      }">
            Q{{ i + 1 }}
            <span class="absolute -top-2 -right-2 text-[10px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded-full">
                {{ getAnsweredSubparts(q) }}
            </span>
        </button>
        }
    </div>

    <button (click)="nextQuestion()" [disabled]="currentQuestionIndex() === questions().length - 1"
        class="text-gray-600 hover:text-gray-900 font-medium text-sm disabled:opacity-40 transition">
        Next
    </button>
</footer>